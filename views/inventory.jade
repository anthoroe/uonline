mixin slot(type, title, capacity)
	- if (!capacity) capacity = 1
	//- TODO: а может просто превратить весь эквипмент в хеш-массив?
	- var items;
	if equipment[type]
		- items = [equipment[type]]
	else
		- items = equipment.filter(function(x){ return x.type == type })
	//- ...and render
	tr
		td(class=(items.length > 0 ? 'text-warning':'text-muted'))
			| #{title}
			if capacity > 1
				| #{' '}
				| (#{items.length}/#{capacity})
		td
			if items.length == 0
				| -

			each item in items
				p
					| #{ item.name }
					| #{' '}
					a.pjax-replace.btn.btn-default.btn-xs(href='/action/unequip/'+item.id) Снять
					br
					span.glyphicon.glyphicon-cog(title='Прочность')
					| #{' '}
					| #{ item.strength }/#{ item.strength_max }
					if item.type !== 'weapon-one-handed'
						| #{' '}&nbsp;#{' '}
						span.glyphicon.glyphicon-stop(title='Покрытие тела')
						| #{' '}
						| #{ item.coverage }%
						if item.type === 'shield'
							- var size = 'средний'
							if item.coverage > 45
								- size = 'большой'
							if item.damage > 0
								- size = 'малый'
							| #{' '}
							span.text-muted (#{size})
					if item.damage > 0
						| #{' '}&nbsp;#{' '}
						span.glyphicon.glyphicon-tint(title='Бонус к урону при ударе')
						//- | #{' '}
						| #{ item.damage }


extends layout
block title
	| Инвентарь
block content
	div.page-header
		h1 Инвентарь
	if character.fight_mode == true
		a.pjax.btn.btn-default.instance-switcher(href='/game/', data-instance='game')
			i.glyphicon.glyphicon-chevron-left
			| #{' '}Вернуться в бой
		hr
	div.row
		div.col-md-6
			table.table.table-striped.table-hover.table-condensed
				thead: tr: td(colspan=2): h3 Оружие
				tbody
					+slot('right_hand', 'Правая рука')
					+slot('shield', 'Щит')
			table.table.table-striped.table-hover.table-condensed
				thead: tr: td(colspan=2): h3 Экипировка
				tbody
					+slot('helmet', 'Голова')
					+slot('necklace', 'Шея', 3)
					+slot('pauldron', 'Плечи', 2)
					+slot('coat', 'Торс')
					if character.race !== 'orc'
						+slot('breastplate', 'Грудь')
					+slot('belt', 'Пояс')
					+slot('vambrace', 'Предплечья', 2)
					+slot('gloves', 'Руки')
					+slot('ring', 'Пальцы', 10)
					+slot('', 'Ноги')
					+slot('', 'Бёдра')
					+slot('', 'Голени')
					+slot('shoes', 'Обувь')
			if character.race === 'orc'
				p Орки не носят нагрудников.
			h3 Читерская кнопка
			a.pjax.btn.btn-default(href='/ajax/cheatFixAll')
				span.glyphicon.glyphicon-cog
				| #{' '}
				| Починить все предметы всем игрокам
		div.col-md-6
			h3 Рюкзак
			if backpack.length === 0
				p В рюкзаке ничего нет.
			else
				table.table.table-striped.table-hover
					thead
						tr
							td: b Название
							td: b Тип
							td: b Прочность
							td: b Покрытие тела
							td: b &nbsp;
					tbody
						each item in backpack
							tr
								td #{ item.name }
								td #{ item.type }
								td #{ item.strength }/#{ item.strength_max }
								td #{ item.coverage }%
								td
									a.pjax-replace.btn.btn-default.btn-xs(href='/action/equip/'+item.id) Надеть
			//-p У вас в рюкзаке ничего нет. Это нормально, потому что на этом сервере нет предметов.
			//-p У вас в рюкзаке ничего нет.
			//-Собирайте предметы с убитых монстров, покупайте у торговцев и делайте сами из подручных материалов.
